---
import Layout from "../../layouts/Layout.astro";
import { getBlogs, getBlogDetail } from "../../libs/microcms";

// 詳細記事ページの全パスを取得
export async function getStaticPaths() {
	const response = await getBlogs({ fields: ["id"] });
	return response.contents.map((content: any) => ({
		params: {
			blogId: content.id,
		},
	}));
}

//記事の詳細情報を取得
const { blogId } = Astro.params;
const blog = await getBlogDetail(blogId as string);
---

<Layout title=`${blog.title}` breadcrumb={true}>
	<main class="inner pt-[160px] sm:pt-[96px] pb-[200px] sm:pb-[64px]">
		<div class="flex gap-[10px] flex-wrap">
			<p
				class="font-bold text-[12px] leading-[1] tracking-[0.06em] px-[20px] pt-[4px] pb-[5px] text-[#FFF] rounded-full sm:text-[10px] sm:pb-[4px]"
				style={`background-color: ${blog.category.labelColor};`}
			>
				{blog.category.name}
			</p>
			{
				blog.readingTime && (
					<p class="font-bold text-[12px] leading-[1] tracking-[0.06em] px-[20px] pt-[4px] pb-[5px] bg-[#F6F6F6] rounded-full sm:text-[10px] sm:pb-[4px]">
						<span class="text-[#666]">読了までの時間：</span>
						{blog.readingTime}分
					</p>
				)
			}
		</div>
		<h1 class="title">{blog.title}</h1>
		<div class="eyecatch">
			<img src=`${blog.eyecatch.url}` alt={blog.title} class="w-full" />
		</div>
		<p class="publishedDate">公開日時：{blog.publishedAt}</p>
		<p class="updateDate">最終更新日時：{blog.updatedAt}</p>
		<div class="post" set:html={blog.content} />
	</main>
</Layout>
